// ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ¶å¾¡ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
const LOG_LEVEL = { ERROR: 1, WARN: 2, INFO: 3, DEBUG: 4 };

// Chrome Storageã‹ã‚‰ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã‚’å–å¾—ï¼ˆéåŒæœŸï¼‰
let CURRENT_LOG_LEVEL = LOG_LEVEL.WARN; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆç°¡æ½”ãªå‹•ä½œç¢ºèªç”¨ï¼‰

// Chromeæ‹¡å¼µç’°å¢ƒã§ã®ã¿Storageã‹ã‚‰è¨­å®šã‚’èª­ã¿è¾¼ã‚€
if (typeof chrome !== "undefined" && chrome.storage && chrome.storage.local) {
  chrome.storage.local.get("logLevel", (result) => {
    if (result.logLevel) {
      CURRENT_LOG_LEVEL = parseInt(result.logLevel);
      console.info(
        `ğŸ“‹ [Log Util] ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«è¨­å®š: ${["", "ERROR", "WARN", "INFO", "DEBUG"][CURRENT_LOG_LEVEL]}`,
      );
    }
  });
}

const log = {
  error: (...args) => {
    if (CURRENT_LOG_LEVEL >= LOG_LEVEL.ERROR) console.error(...args);
  },
  warn: (...args) => {
    if (CURRENT_LOG_LEVEL >= LOG_LEVEL.WARN) console.warn(...args);
  },
  info: (...args) => {
    if (CURRENT_LOG_LEVEL >= LOG_LEVEL.INFO) console.log(...args);
  },
  debug: (...args) => {
    if (CURRENT_LOG_LEVEL >= LOG_LEVEL.DEBUG) console.log(...args);
  },
};

// ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹
if (typeof window !== "undefined") {
  window.log = log;
}
