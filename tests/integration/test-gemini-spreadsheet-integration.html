<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Spreadsheet Integration Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #2196F3 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 10px;
            border: 1px solid #e0e0e0;
        }

        .section h2 {
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon {
            font-size: 1.5em;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #2196F3 0%, #21CBF3 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            color: white;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        input[type="text"], input[type="number"], select, textarea {
            flex: 1;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, input[type="number"]:focus, 
        select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        .status {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
        }

        .status.success {
            background: #e8f5e9;
            border-left-color: #4CAF50;
        }

        .status.error {
            background: #ffebee;
            border-left-color: #f44336;
        }

        .status.warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin-top: 10px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .result-container {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
        }

        .result-item {
            padding: 10px;
            border-bottom: 1px solid #f0f0f0;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-success {
            background: #e8f5e9;
        }

        .result-error {
            background: #ffebee;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 10px;
        }

        .badge-success {
            background: #4CAF50;
            color: white;
        }

        .badge-error {
            background: #f44336;
            color: white;
        }

        .badge-warning {
            background: #ff9800;
            color: white;
        }

        .badge-info {
            background: #2196F3;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 Gemini Spreadsheet Integration Test</h1>
            <p>既存Geminiコードとスプレッドシートの統合テスト環境</p>
        </div>

        <div class="content">
            <!-- セットアップセクション -->
            <div class="section">
                <h2><span class="icon">⚙️</span>セットアップ</h2>
                <div class="button-group">
                    <button class="btn-primary" onclick="loadScripts()">
                        <span>📦</span>スクリプト読み込み
                    </button>
                    <button class="btn-success" onclick="initializeIntegration()">
                        <span>🚀</span>統合初期化
                    </button>
                    <button class="btn-info" onclick="checkStatus()">
                        <span>✅</span>状態確認
                    </button>
                </div>
                <div id="setup-status" class="status" style="display:none;"></div>
            </div>

            <!-- 手動テストセクション -->
            <div class="section">
                <h2><span class="icon">🧪</span>手動テスト</h2>
                
                <div class="input-group">
                    <div style="flex:1;">
                        <label for="test-model">モデル:</label>
                        <select id="test-model">
                            <option value="">なし</option>
                            <option value="Flash 2.0">Flash 2.0</option>
                            <option value="Pro">Pro</option>
                            <option value="Pro 1.5">Pro 1.5</option>
                        </select>
                    </div>
                    <div style="flex:1;">
                        <label for="test-function">機能:</label>
                        <select id="test-function">
                            <option value="">なし</option>
                            <option value="Deep Research">Deep Research</option>
                            <option value="画像">画像生成</option>
                            <option value="コード">コード実行</option>
                        </select>
                    </div>
                </div>

                <div>
                    <label for="test-text">テキスト:</label>
                    <textarea id="test-text" placeholder="Geminiに送信するテキストを入力...">こんにちは、今日の天気はどうですか？</textarea>
                </div>

                <div class="button-group">
                    <button class="btn-success" onclick="executeManualTest()">
                        <span>▶️</span>テスト実行
                    </button>
                    <button class="btn-info" onclick="executeDeepResearchTest()">
                        <span>🔬</span>Deep Research テスト
                    </button>
                    <button class="btn-warning" onclick="clearAllFunctions()">
                        <span>🔧</span>機能クリア
                    </button>
                </div>

                <div id="manual-result" class="result-container" style="display:none;"></div>
            </div>

            <!-- サンプルデータテスト -->
            <div class="section">
                <h2><span class="icon">📊</span>サンプルデータテスト</h2>
                
                <div class="button-group">
                    <button class="btn-success" onclick="generateSampleData()">
                        <span>📝</span>サンプル生成
                    </button>
                    <button class="btn-info" onclick="executeSingleSample()">
                        <span>▶️</span>単一実行
                    </button>
                    <button class="btn-warning" onclick="executeBatchSample()">
                        <span>⚡</span>バッチ実行
                    </button>
                </div>

                <div id="sample-data" class="code-block" style="display:none;"></div>
                <div id="sample-result" class="result-container" style="display:none;"></div>
            </div>

            <!-- スプレッドシート連携 -->
            <div class="section">
                <h2><span class="icon">📑</span>スプレッドシート連携（アダプター）</h2>
                
                <div class="input-group">
                    <input type="text" id="spreadsheet-url" placeholder="スプレッドシートのURLを入力...">
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="loadSpreadsheet()">
                        <span>📂</span>読み込み
                    </button>
                    <button class="btn-success" onclick="executeSpreadsheetRow()">
                        <span>▶️</span>行を実行
                    </button>
                    <button class="btn-warning" onclick="executeAllRows()">
                        <span>⚡</span>全行実行
                    </button>
                </div>

                <div class="input-group" style="margin-top:15px;">
                    <input type="number" id="row-number" placeholder="行番号" min="1" style="width:150px;">
                </div>

                <div id="spreadsheet-status" class="status" style="display:none;"></div>
                <div id="spreadsheet-result" class="result-container" style="display:none;"></div>
            </div>

            <!-- 実行履歴 -->
            <div class="section">
                <h2><span class="icon">📜</span>実行履歴</h2>
                
                <div class="button-group">
                    <button class="btn-info" onclick="showHistory()">
                        <span>📋</span>履歴表示
                    </button>
                    <button class="btn-success" onclick="exportHistory('json')">
                        <span>💾</span>JSON出力
                    </button>
                    <button class="btn-success" onclick="exportHistory('csv')">
                        <span>📊</span>CSV出力
                    </button>
                    <button class="btn-danger" onclick="clearHistory()">
                        <span>🗑️</span>履歴クリア
                    </button>
                </div>

                <div id="history-result" class="result-container" style="display:none;"></div>
            </div>

            <!-- ローディング表示 -->
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p style="margin-top:15px;">処理中...</p>
            </div>
        </div>
    </div>

    <script>
        // グローバル変数
        let integration = null;
        let adapter = null;
        let isInitialized = false;

        // スクリプト読み込み
        async function loadScripts() {
            showLoading(true);
            updateStatus('setup-status', 'スクリプトを読み込み中...', 'info');

            try {
                // 既存のGeminiコードを読み込み（実際の環境では適切なパスに変更）
                await loadScript('gemini-automation-control.js');
                await new Promise(resolve => setTimeout(resolve, 1000));

                // 統合レイヤーを読み込み
                await loadScript('gemini-spreadsheet-integration.js');
                await new Promise(resolve => setTimeout(resolve, 500));

                // アダプターを読み込み
                await loadScript('gemini-spreadsheet-adapter.js');
                await new Promise(resolve => setTimeout(resolve, 500));

                updateStatus('setup-status', '✅ スクリプト読み込み完了', 'success');
            } catch (error) {
                updateStatus('setup-status', `❌ 読み込みエラー: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        }

        // スクリプト動的読み込み
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = () => reject(new Error(`Failed to load ${src}`));
                document.head.appendChild(script);
            });
        }

        // 統合初期化
        async function initializeIntegration() {
            if (!window.Gemini) {
                updateStatus('setup-status', '❌ Geminiが読み込まれていません', 'error');
                return;
            }

            showLoading(true);
            updateStatus('setup-status', '統合レイヤーを初期化中...', 'info');

            try {
                // GeminiIntegrationの初期化
                integration = new window.GeminiIntegration(window.Gemini);
                integration.setDebugMode(true);

                // アダプターの初期化（sheetsClientがある場合）
                if (window.setupGeminiSpreadsheetIntegration) {
                    adapter = await window.setupGeminiSpreadsheetIntegration();
                }

                isInitialized = true;
                updateStatus('setup-status', '✅ 統合初期化完了！', 'success');
            } catch (error) {
                updateStatus('setup-status', `❌ 初期化エラー: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        }

        // 状態確認
        function checkStatus() {
            const status = {
                gemini: !!window.Gemini,
                integration: !!integration,
                adapter: !!adapter,
                initialized: isInitialized
            };

            let message = '<strong>システム状態:</strong><br>';
            message += `Gemini: ${status.gemini ? '✅' : '❌'}<br>`;
            message += `Integration: ${status.integration ? '✅' : '❌'}<br>`;
            message += `Adapter: ${status.adapter ? '✅' : '❌'}<br>`;
            message += `初期化済み: ${status.initialized ? '✅' : '❌'}`;

            updateStatus('setup-status', message, status.initialized ? 'success' : 'warning');
        }

        // 手動テスト実行
        async function executeManualTest() {
            if (!integration) {
                alert('先に統合を初期化してください');
                return;
            }

            const data = {
                model: document.getElementById('test-model').value,
                function: document.getElementById('test-function').value,
                text: document.getElementById('test-text').value
            };

            if (!data.text) {
                alert('テキストを入力してください');
                return;
            }

            showLoading(true);
            showResult('manual-result', '実行中...');

            try {
                const result = await integration.executeFromSpreadsheet(data);
                
                let html = '<h3>実行結果</h3>';
                html += `<div class="result-item ${result.success ? 'result-success' : 'result-error'}">`;
                html += `<strong>成功:</strong> ${result.success}<br>`;
                html += `<strong>実行時間:</strong> ${result.duration}ms<br>`;
                
                if (result.result?.response) {
                    const response = result.result.response;
                    html += `<strong>応答:</strong><br>`;
                    html += `<div class="code-block">${escapeHtml(response.substring(0, 500))}${response.length > 500 ? '...' : ''}</div>`;
                    html += `<strong>文字数:</strong> ${response.length}`;
                }
                
                if (result.error) {
                    html += `<strong>エラー:</strong> ${result.error}`;
                }
                
                html += '</div>';
                
                showResult('manual-result', html);
            } catch (error) {
                showResult('manual-result', `<div class="result-item result-error">エラー: ${error.message}</div>`);
            } finally {
                showLoading(false);
            }
        }

        // Deep Researchテスト
        async function executeDeepResearchTest() {
            if (!integration) {
                alert('先に統合を初期化してください');
                return;
            }

            const data = {
                model: 'Pro',
                function: 'Deep Research',
                text: 'AIの最新動向について詳しく調査してください',
                maxWaitMinutes: 20
            };

            if (confirm('Deep Researchテストを実行しますか？（最大20分かかる場合があります）')) {
                showLoading(true);
                showResult('manual-result', 'Deep Research実行中... これには時間がかかります。');

                try {
                    const result = await integration.executeFromSpreadsheet(data);
                    
                    let html = '<h3>Deep Research結果</h3>';
                    html += `<div class="result-item result-success">`;
                    html += `<strong>成功:</strong> ${result.success}<br>`;
                    html += `<strong>実行時間:</strong> ${Math.floor(result.duration / 60000)}分<br>`;
                    
                    if (result.result?.response) {
                        const response = result.result.response;
                        html += `<strong>調査結果:</strong><br>`;
                        html += `<div class="code-block">${escapeHtml(response.substring(0, 1000))}${response.length > 1000 ? '...' : ''}</div>`;
                        html += `<strong>文字数:</strong> ${response.length}`;
                    }
                    
                    html += '</div>';
                    
                    showResult('manual-result', html);
                } catch (error) {
                    showResult('manual-result', `<div class="result-item result-error">エラー: ${error.message}</div>`);
                } finally {
                    showLoading(false);
                }
            }
        }

        // 機能クリア
        async function clearAllFunctions() {
            if (!window.Gemini) {
                alert('Geminiが読み込まれていません');
                return;
            }

            showLoading(true);
            try {
                await window.Gemini.clearFunctions();
                updateStatus('manual-result', '✅ すべての機能をクリアしました', 'success');
            } catch (error) {
                updateStatus('manual-result', `❌ エラー: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        }

        // サンプルデータ生成
        function generateSampleData() {
            const samples = [
                {
                    model: 'Flash 2.0',
                    function: '',
                    text: 'こんにちは、今日の天気はどうですか？'
                },
                {
                    model: 'Pro',
                    function: 'Deep Research',
                    text: 'AIの最新動向について詳しく調査してください'
                },
                {
                    model: 'Flash',
                    function: '画像',
                    text: '美しい夕日の風景を生成してください'
                }
            ];

            window.sampleData = samples;
            
            const html = JSON.stringify(samples, null, 2);
            document.getElementById('sample-data').style.display = 'block';
            document.getElementById('sample-data').textContent = html;
        }

        // 単一サンプル実行
        async function executeSingleSample() {
            if (!integration || !window.sampleData) {
                alert('先に統合を初期化し、サンプルデータを生成してください');
                return;
            }

            showLoading(true);
            showResult('sample-result', '実行中...');

            try {
                const result = await integration.executeFromSpreadsheet(window.sampleData[0]);
                showResult('sample-result', formatExecutionResult(result));
            } catch (error) {
                showResult('sample-result', `<div class="result-item result-error">エラー: ${error.message}</div>`);
            } finally {
                showLoading(false);
            }
        }

        // バッチサンプル実行
        async function executeBatchSample() {
            if (!integration || !window.sampleData) {
                alert('先に統合を初期化し、サンプルデータを生成してください');
                return;
            }

            showLoading(true);
            showResult('sample-result', 'バッチ実行中...');

            try {
                const results = await integration.executeBatch(window.sampleData, {
                    pauseBetweenTasks: 3000,
                    stopOnError: false
                });

                let html = '<h3>バッチ実行結果</h3>';
                results.forEach((result, index) => {
                    html += `<div class="result-item ${result.success ? 'result-success' : 'result-error'}">`;
                    html += `<strong>タスク ${index + 1}:</strong> `;
                    html += result.success ? 
                        `<span class="badge badge-success">成功</span>` : 
                        `<span class="badge badge-error">失敗</span>`;
                    
                    if (result.result?.responseLength) {
                        html += ` (応答: ${result.result.responseLength}文字)`;
                    }
                    if (result.error) {
                        html += ` - ${result.error}`;
                    }
                    html += '</div>';
                });

                showResult('sample-result', html);
            } catch (error) {
                showResult('sample-result', `<div class="result-item result-error">エラー: ${error.message}</div>`);
            } finally {
                showLoading(false);
            }
        }

        // スプレッドシート読み込み
        async function loadSpreadsheet() {
            if (!adapter) {
                alert('アダプターが初期化されていません');
                return;
            }

            const url = document.getElementById('spreadsheet-url').value;
            if (!url) {
                alert('スプレッドシートのURLを入力してください');
                return;
            }

            showLoading(true);
            
            try {
                const { spreadsheetId, gid } = window.parseSpreadsheetUrl(url);
                if (!spreadsheetId) {
                    throw new Error('無効なスプレッドシートURL');
                }

                const data = await adapter.loadSpreadsheet(spreadsheetId, gid);
                
                updateStatus('spreadsheet-status', 
                    `✅ スプレッドシート読み込み完了<br>` +
                    `作業行: ${data.workRows.length}行<br>` +
                    `列マッピング: ${Object.keys(data.columnMapping).length}列`, 
                    'success'
                );
            } catch (error) {
                updateStatus('spreadsheet-status', `❌ エラー: ${error.message}`, 'error');
            } finally {
                showLoading(false);
            }
        }

        // スプレッドシート行実行
        async function executeSpreadsheetRow() {
            if (!adapter || !adapter.loadedData) {
                alert('先にスプレッドシートを読み込んでください');
                return;
            }

            const rowNumber = parseInt(document.getElementById('row-number').value);
            if (!rowNumber) {
                alert('行番号を入力してください');
                return;
            }

            showLoading(true);
            
            try {
                const result = await adapter.executeRow(rowNumber);
                showResult('spreadsheet-result', formatExecutionResult(result));
            } catch (error) {
                showResult('spreadsheet-result', `<div class="result-item result-error">エラー: ${error.message}</div>`);
            } finally {
                showLoading(false);
            }
        }

        // 全行実行
        async function executeAllRows() {
            if (!adapter || !adapter.loadedData) {
                alert('先にスプレッドシートを読み込んでください');
                return;
            }

            if (!confirm('すべての行を実行しますか？')) {
                return;
            }

            showLoading(true);
            
            try {
                const results = await adapter.executeRows();
                
                let html = '<h3>全行実行結果</h3>';
                const successCount = results.filter(r => r.success && !r.skipped).length;
                const skipCount = results.filter(r => r.skipped).length;
                const failCount = results.filter(r => !r.success && !r.skipped).length;
                
                html += `<div class="status success">`;
                html += `成功: ${successCount}行 | スキップ: ${skipCount}行 | 失敗: ${failCount}行`;
                html += `</div>`;
                
                showResult('spreadsheet-result', html);
            } catch (error) {
                showResult('spreadsheet-result', `<div class="result-item result-error">エラー: ${error.message}</div>`);
            } finally {
                showLoading(false);
            }
        }

        // 履歴表示
        function showHistory() {
            if (!integration) {
                alert('統合が初期化されていません');
                return;
            }

            const history = integration.getHistory();
            
            if (history.length === 0) {
                showResult('history-result', '<p>実行履歴はありません</p>');
                return;
            }

            let html = '<h3>実行履歴</h3>';
            history.forEach((item, index) => {
                html += `<div class="result-item">`;
                html += `<strong>#${index + 1}</strong> `;
                html += `${new Date(item.timestamp).toLocaleString()} - `;
                html += item.success ? 
                    `<span class="badge badge-success">成功</span>` : 
                    `<span class="badge badge-error">失敗</span>`;
                
                if (item.mappedTask?.text) {
                    html += `<br>テキスト: ${item.mappedTask.text.substring(0, 50)}...`;
                }
                html += '</div>';
            });
            
            showResult('history-result', html);
        }

        // 履歴エクスポート
        function exportHistory(format) {
            if (!integration) {
                alert('統合が初期化されていません');
                return;
            }

            try {
                const data = integration.exportResults(format);
                
                // ダウンロード処理
                const blob = new Blob([data], { 
                    type: format === 'json' ? 'application/json' : 'text/csv' 
                });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `gemini-history-${Date.now()}.${format}`;
                a.click();
                URL.revokeObjectURL(url);
                
                updateStatus('history-result', `✅ ${format.toUpperCase()}形式でエクスポートしました`, 'success');
            } catch (error) {
                updateStatus('history-result', `❌ エクスポートエラー: ${error.message}`, 'error');
            }
        }

        // 履歴クリア
        function clearHistory() {
            if (!integration) {
                alert('統合が初期化されていません');
                return;
            }

            if (confirm('実行履歴をクリアしますか？')) {
                integration.clearHistory();
                updateStatus('history-result', '✅ 履歴をクリアしました', 'success');
            }
        }

        // ユーティリティ関数
        function showLoading(show) {
            document.getElementById('loading').classList.toggle('active', show);
        }

        function updateStatus(elementId, message, type) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `status ${type}`;
            element.innerHTML = message;
        }

        function showResult(elementId, html) {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.innerHTML = html;
        }

        function formatExecutionResult(result) {
            let html = '<h3>実行結果</h3>';
            html += `<div class="result-item ${result.success ? 'result-success' : 'result-error'}">`;
            
            if (result.skipped) {
                html += '<strong>スキップされました</strong>';
            } else {
                html += `<strong>成功:</strong> ${result.success}<br>`;
                
                if (result.duration) {
                    html += `<strong>実行時間:</strong> ${result.duration}ms<br>`;
                }
                
                if (result.result?.response) {
                    const response = result.result.response;
                    html += `<strong>応答:</strong><br>`;
                    html += `<div class="code-block">${escapeHtml(response.substring(0, 500))}${response.length > 500 ? '...' : ''}</div>`;
                    html += `<strong>文字数:</strong> ${response.length}`;
                }
                
                if (result.error) {
                    html += `<strong>エラー:</strong> ${result.error}`;
                }
            }
            
            html += '</div>';
            return html;
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ページ読み込み時の初期化
        window.addEventListener('load', () => {
            console.log('Gemini Spreadsheet Integration Test Page Loaded');
        });
    </script>
</body>
</html>