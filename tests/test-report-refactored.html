<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        
        .section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .section h2 {
            color: #555;
            margin-top: 0;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        button.danger {
            background-color: #f44336;
        }
        
        button.danger:hover {
            background-color: #da190b;
        }
        
        button.info {
            background-color: #2196F3;
        }
        
        button.info:hover {
            background-color: #0b7dda;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .config-item {
            padding: 10px;
            background: #f9f9f9;
            border-radius: 4px;
            border-left: 3px solid #4CAF50;
        }
        
        .config-item label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
        
        .config-item input,
        .config-item select {
            width: 100%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        
        .log-area {
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 3px;
        }
        
        .log-debug { color: #666; }
        .log-info { color: #333; }
        .log-warn { color: #ff9800; background: #fff3e0; }
        .log-error { color: #f44336; background: #ffebee; }
        .log-success { color: #4CAF50; background: #e8f5e9; }
        
        .status-bar {
            padding: 10px;
            background: #e3f2fd;
            border-radius: 4px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .status-active { background: #4CAF50; }
        .status-inactive { background: #f44336; }
        .status-processing { background: #ff9800; animation: pulse 1s infinite; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .test-results {
            margin-top: 20px;
        }
        
        .result-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            background: #f5f5f5;
            border-left: 3px solid #2196F3;
        }
        
        .result-success {
            border-left-color: #4CAF50;
            background: #e8f5e9;
        }
        
        .result-error {
            border-left-color: #f44336;
            background: #ffebee;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ</h1>

    <div class="status-bar">
        <div>
            <span class="status-indicator status-inactive" id="status-indicator"></span>
            <span id="status-text">æº–å‚™å®Œäº†</span>
        </div>
        <div id="status-details"></div>
    </div>

    <div class="section">
        <h2>âš™ï¸ è¨­å®šç®¡ç†</h2>
        <div class="config-grid">
            <div class="config-item">
                <label>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆAIã‚¿ã‚¤ãƒ—</label>
                <select id="config-ai-type">
                    <option value="chatgpt">ChatGPT</option>
                    <option value="claude">Claude</option>
                    <option value="gemini">Gemini</option>
                </select>
            </div>
            <div class="config-item">
                <label>ä¸¦åˆ—å®Ÿè¡Œ</label>
                <select id="config-parallel">
                    <option value="false">ç„¡åŠ¹</option>
                    <option value="true">æœ‰åŠ¹</option>
                </select>
            </div>
            <div class="config-item">
                <label>æœ€å¤§åŒæ™‚å®Ÿè¡Œæ•°</label>
                <input type="number" id="config-max-concurrent" value="3" min="1" max="10">
            </div>
            <div class="config-item">
                <label>ãƒªãƒˆãƒ©ã‚¤å›æ•°</label>
                <input type="number" id="config-retry" value="3" min="0" max="5">
            </div>
            <div class="config-item">
                <label>ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«</label>
                <select id="config-log-level">
                    <option value="debug">Debug</option>
                    <option value="info">Info</option>
                    <option value="warn">Warn</option>
                    <option value="error">Error</option>
                </select>
            </div>
            <div class="config-item">
                <label>ã‚­ãƒ£ãƒƒã‚·ãƒ¥</label>
                <select id="config-cache">
                    <option value="true">æœ‰åŠ¹</option>
                    <option value="false">ç„¡åŠ¹</option>
                </select>
            </div>
        </div>
        <div class="button-group">
            <button onclick="applyConfig()">è¨­å®šã‚’é©ç”¨</button>
            <button onclick="resetConfig()" class="danger">è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆ</button>
            <button onclick="exportConfig()" class="info">è¨­å®šã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ§ª ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ</h2>
        <div class="button-group">
            <button onclick="testTaskFactory()">TaskFactoryãƒ†ã‚¹ãƒˆ</button>
            <button onclick="testExecutor()">Executorãƒ†ã‚¹ãƒˆ</button>
            <button onclick="testConfig()">Configãƒ†ã‚¹ãƒˆ</button>
            <button onclick="testIntegration()">çµ±åˆãƒ†ã‚¹ãƒˆ</button>
            <button onclick="runAllTests()">å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
        </div>
        <div class="test-results" id="test-results"></div>
    </div>

    <div class="section">
        <h2>ğŸ“Š å®Ÿå‹•ä½œãƒ†ã‚¹ãƒˆ</h2>
        <div class="button-group">
            <button onclick="testCreateTask()">ã‚¿ã‚¹ã‚¯ä½œæˆ</button>
            <button onclick="testExecuteTask()">ã‚¿ã‚¹ã‚¯å®Ÿè¡Œ</button>
            <button onclick="testBatchExecution()">ãƒãƒƒãƒå®Ÿè¡Œ</button>
            <button onclick="testFullCycle()">ãƒ•ãƒ«ã‚µã‚¤ã‚¯ãƒ«</button>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“ ãƒ­ã‚°å‡ºåŠ›</h2>
        <div class="button-group">
            <button onclick="clearLog()">ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢</button>
            <button onclick="downloadLog()" class="info">ãƒ­ã‚°ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        </div>
        <div class="log-area" id="log-area"></div>
    </div>

    <script type="module">
        // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        import ReportService from '/src/features/report/index.js';
        import { ReportTaskFactory } from '/src/features/report/report-task-factory.js';
        import { ReportExecutor } from '/src/features/report/report-executor.js';
        import { ReportConfig, getReportConfig, resetReportConfig } from '/src/features/report/report-config.js';
        
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let reportService = null;
        let testResults = [];
        
        // åˆæœŸåŒ–
        window.addEventListener('DOMContentLoaded', () => {
            initializeService();
            addLog('info', 'ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸ');
        });
        
        // ã‚µãƒ¼ãƒ“ã‚¹ã®åˆæœŸåŒ–
        function initializeService() {
            const config = {
                defaultAIType: document.getElementById('config-ai-type').value,
                execution: {
                    parallel: document.getElementById('config-parallel').value === 'true',
                    maxConcurrent: parseInt(document.getElementById('config-max-concurrent').value),
                    retryAttempts: parseInt(document.getElementById('config-retry').value)
                },
                logging: {
                    level: document.getElementById('config-log-level').value,
                    enabled: true
                },
                performance: {
                    cacheEnabled: document.getElementById('config-cache').value === 'true'
                }
            };
            
            reportService = new ReportService(config);
            updateStatus('active', 'ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–å®Œäº†');
            
            // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«å…¬é–‹ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
            window.reportService = reportService;
        }
        
        // è¨­å®šã®é©ç”¨
        window.applyConfig = function() {
            try {
                initializeService();
                addLog('success', 'è¨­å®šã‚’é©ç”¨ã—ã¾ã—ãŸ');
                showConfigSummary();
            } catch (error) {
                addLog('error', 'è¨­å®šã®é©ç”¨ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            }
        };
        
        // è¨­å®šã®ãƒªã‚»ãƒƒãƒˆ
        window.resetConfig = function() {
            resetReportConfig();
            initializeService();
            addLog('info', 'è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
            
            // UIã‚‚ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('config-ai-type').value = 'chatgpt';
            document.getElementById('config-parallel').value = 'false';
            document.getElementById('config-max-concurrent').value = '3';
            document.getElementById('config-retry').value = '3';
            document.getElementById('config-log-level').value = 'info';
            document.getElementById('config-cache').value = 'true';
        };
        
        // è¨­å®šã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        window.exportConfig = function() {
            const config = reportService.getConfig();
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'report-config.json';
            a.click();
            URL.revokeObjectURL(url);
            addLog('info', 'è¨­å®šã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
        };
        
        // TaskFactoryãƒ†ã‚¹ãƒˆ
        window.testTaskFactory = async function() {
            updateStatus('processing', 'TaskFactoryãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            const results = [];
            
            try {
                // ãƒ†ã‚¹ãƒˆ1: æ­£å¸¸ãªã‚¿ã‚¹ã‚¯ä½œæˆ
                const factory = new ReportTaskFactory();
                const task = factory.createTask({
                    sourceColumn: 'D',
                    reportColumn: 'V',
                    rowNumber: 5,
                    aiType: 'chatgpt',
                    columnGroup: { promptColumn: 'C', type: 'single' }
                }, {
                    spreadsheetId: 'test-id',
                    gid: '0'
                });
                
                results.push({
                    name: 'ã‚¿ã‚¹ã‚¯ä½œæˆ',
                    success: task && task.id && task.taskType === 'report',
                    message: task ? 'ã‚¿ã‚¹ã‚¯ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ' : 'ã‚¿ã‚¹ã‚¯ä½œæˆå¤±æ•—'
                });
                
                // ãƒ†ã‚¹ãƒˆ2: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼
                let validationError = null;
                try {
                    factory.createTask({}, {});
                } catch (error) {
                    validationError = error;
                }
                
                results.push({
                    name: 'ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼',
                    success: validationError !== null,
                    message: validationError ? 'æ¤œè¨¼ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™' : 'æ¤œè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã›ã‚“ã§ã—ãŸ'
                });
                
            } catch (error) {
                results.push({
                    name: 'TaskFactoryå…¨ä½“',
                    success: false,
                    message: error.message
                });
            }
            
            displayTestResults(results);
            updateStatus('active', 'TaskFactoryãƒ†ã‚¹ãƒˆå®Œäº†');
        };
        
        // Executorãƒ†ã‚¹ãƒˆ
        window.testExecutor = async function() {
            updateStatus('processing', 'Executorãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            const results = [];
            
            try {
                const executor = new ReportExecutor();
                
                // ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯
                const testTask = {
                    id: 'test-task-1',
                    taskType: 'report',
                    sourceColumn: 'D',
                    reportColumn: 'V',
                    row: 5,
                    promptColumn: 'C',
                    metadata: {
                        originalPrompt: 'ãƒ†ã‚¹ãƒˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ',
                        aiAnswer: 'ãƒ†ã‚¹ãƒˆå›ç­”'
                    }
                };
                
                // ãƒ†ã‚¹ãƒˆç”¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿
                const testData = {
                    spreadsheetId: 'test-id',
                    gid: '0',
                    values: [
                        ['ç•ªå·', 'åˆ¶å¾¡', 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ', 'å›ç­”', 'ãƒ¬ãƒãƒ¼ãƒˆ'],
                        ['1', '', 'ãƒ†ã‚¹ãƒˆè³ªå•', 'ãƒ†ã‚¹ãƒˆå›ç­”', '']
                    ]
                };
                
                results.push({
                    name: 'ExecutoråˆæœŸåŒ–',
                    success: true,
                    message: 'ExecutorãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ'
                });
                
            } catch (error) {
                results.push({
                    name: 'Executorå…¨ä½“',
                    success: false,
                    message: error.message
                });
            }
            
            displayTestResults(results);
            updateStatus('active', 'Executorãƒ†ã‚¹ãƒˆå®Œäº†');
        };
        
        // Configãƒ†ã‚¹ãƒˆ
        window.testConfig = async function() {
            updateStatus('processing', 'Configãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            const results = [];
            
            try {
                // ãƒ†ã‚¹ãƒˆ1: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š
                const config = new ReportConfig();
                results.push({
                    name: 'ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š',
                    success: config.get('defaultAIType') === 'chatgpt',
                    message: 'ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šãŒæ­£ã—ãåˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ'
                });
                
                // ãƒ†ã‚¹ãƒˆ2: è¨­å®šã®æ›´æ–°
                config.set('execution.parallel', true);
                results.push({
                    name: 'è¨­å®šæ›´æ–°',
                    success: config.get('execution.parallel') === true,
                    message: 'è¨­å®šãŒæ­£ã—ãæ›´æ–°ã•ã‚Œã¾ã—ãŸ'
                });
                
                // ãƒ†ã‚¹ãƒˆ3: è¨­å®šã®æ¤œè¨¼
                let validationError = null;
                try {
                    config.set('defaultAIType', 'invalid-ai');
                    config.validateConfig();
                } catch (error) {
                    validationError = error;
                }
                
                results.push({
                    name: 'è¨­å®šæ¤œè¨¼',
                    success: validationError !== null,
                    message: 'ä¸æ­£ãªè¨­å®šãŒæ­£ã—ãæ¤œå‡ºã•ã‚Œã¾ã—ãŸ'
                });
                
            } catch (error) {
                results.push({
                    name: 'Configå…¨ä½“',
                    success: false,
                    message: error.message
                });
            }
            
            displayTestResults(results);
            updateStatus('active', 'Configãƒ†ã‚¹ãƒˆå®Œäº†');
        };
        
        // çµ±åˆãƒ†ã‚¹ãƒˆ
        window.testIntegration = async function() {
            updateStatus('processing', 'çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
            const results = [];
            
            try {
                // ã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“ã®çµ±åˆãƒ†ã‚¹ãƒˆ
                const service = new ReportService();
                
                // ãƒ†ã‚¹ãƒˆ1: ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–
                results.push({
                    name: 'ã‚µãƒ¼ãƒ“ã‚¹åˆæœŸåŒ–',
                    success: service !== null,
                    message: 'ã‚µãƒ¼ãƒ“ã‚¹ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ'
                });
                
                // ãƒ†ã‚¹ãƒˆ2: ã‚¿ã‚¹ã‚¯ä½œæˆ
                const task = service.createTask({
                    sourceColumn: 'D',
                    reportColumn: 'V',
                    rowNumber: 5,
                    aiType: 'chatgpt',
                    columnGroup: { promptColumn: 'C', type: 'single' }
                }, {
                    spreadsheetId: 'test-id',
                    gid: '0'
                });
                
                results.push({
                    name: 'ã‚¿ã‚¹ã‚¯ä½œæˆï¼ˆçµ±åˆï¼‰',
                    success: task !== null,
                    message: 'ã‚¿ã‚¹ã‚¯ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ'
                });
                
                // ãƒ†ã‚¹ãƒˆ3: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—
                const status = service.getStatus();
                results.push({
                    name: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—',
                    success: status && status.isEnabled,
                    message: 'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒæ­£å¸¸ã«å–å¾—ã§ãã¾ã—ãŸ'
                });
                
            } catch (error) {
                results.push({
                    name: 'çµ±åˆãƒ†ã‚¹ãƒˆå…¨ä½“',
                    success: false,
                    message: error.message
                });
            }
            
            displayTestResults(results);
            updateStatus('active', 'çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†');
        };
        
        // å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        window.runAllTests = async function() {
            clearTestResults();
            await testTaskFactory();
            await testExecutor();
            await testConfig();
            await testIntegration();
            addLog('success', 'å…¨ãƒ†ã‚¹ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸ');
        };
        
        // ãƒ†ã‚¹ãƒˆçµæœã®è¡¨ç¤º
        function displayTestResults(results) {
            const container = document.getElementById('test-results');
            
            results.forEach(result => {
                const div = document.createElement('div');
                div.className = `result-item ${result.success ? 'result-success' : 'result-error'}`;
                div.innerHTML = `
                    <strong>${result.success ? 'âœ…' : 'âŒ'} ${result.name}</strong>
                    <div>${result.message}</div>
                `;
                container.appendChild(div);
            });
        }
        
        // ãƒ†ã‚¹ãƒˆçµæœã®ã‚¯ãƒªã‚¢
        function clearTestResults() {
            document.getElementById('test-results').innerHTML = '';
        }
        
        // ãƒ­ã‚°è¿½åŠ 
        function addLog(level, message) {
            const logArea = document.getElementById('log-area');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${level}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] [${level.toUpperCase()}] ${message}`;
            logArea.appendChild(entry);
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        // ãƒ­ã‚°ã‚¯ãƒªã‚¢
        window.clearLog = function() {
            document.getElementById('log-area').innerHTML = '';
            addLog('info', 'ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
        };
        
        // ãƒ­ã‚°ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        window.downloadLog = function() {
            const logArea = document.getElementById('log-area');
            const text = logArea.innerText;
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'report-test-log.txt';
            a.click();
            URL.revokeObjectURL(url);
        };
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
        function updateStatus(type, message) {
            const indicator = document.getElementById('status-indicator');
            const text = document.getElementById('status-text');
            
            indicator.className = `status-indicator status-${type}`;
            text.textContent = message;
        }
        
        // è¨­å®šã‚µãƒãƒªãƒ¼è¡¨ç¤º
        function showConfigSummary() {
            const summary = reportService.getStatus().configSummary;
            const details = document.getElementById('status-details');
            details.textContent = `AI: ${summary.defaultAIType} | ä¸¦åˆ—: ${summary.parallelExecution ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹'} | ã‚­ãƒ£ãƒƒã‚·ãƒ¥: ${summary.cacheEnabled ? 'æœ‰åŠ¹' : 'ç„¡åŠ¹'}`;
        }
        
        // å®Ÿå‹•ä½œãƒ†ã‚¹ãƒˆé–¢æ•°
        window.testCreateTask = function() {
            try {
                const task = reportService.createTask({
                    sourceColumn: 'D',
                    reportColumn: 'V',
                    rowNumber: 10,
                    aiType: 'chatgpt',
                    columnGroup: { promptColumn: 'C', type: 'single' }
                }, {
                    spreadsheetId: 'demo-spreadsheet',
                    gid: '0'
                });
                
                addLog('success', `ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã—ãŸ: ${task.id}`);
                console.log('ä½œæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯:', task);
            } catch (error) {
                addLog('error', `ã‚¿ã‚¹ã‚¯ä½œæˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        };
        
        window.testExecuteTask = function() {
            addLog('info', 'ã‚¿ã‚¹ã‚¯å®Ÿè¡Œãƒ†ã‚¹ãƒˆã¯å®Ÿéš›ã®APIãŒå¿…è¦ãªãŸã‚ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã¿å®Ÿè¡Œã—ã¾ã™');
        };
        
        window.testBatchExecution = function() {
            addLog('info', 'ãƒãƒƒãƒå®Ÿè¡Œãƒ†ã‚¹ãƒˆã¯å®Ÿéš›ã®APIãŒå¿…è¦ãªãŸã‚ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã¿å®Ÿè¡Œã—ã¾ã™');
        };
        
        window.testFullCycle = function() {
            addLog('info', 'ãƒ•ãƒ«ã‚µã‚¤ã‚¯ãƒ«ãƒ†ã‚¹ãƒˆã¯å®Ÿéš›ã®APIãŒå¿…è¦ãªãŸã‚ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã¿å®Ÿè¡Œã—ã¾ã™');
        };
    </script>
</body>
</html>