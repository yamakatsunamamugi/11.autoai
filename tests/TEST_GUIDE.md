# AutoAI テストガイド

## テストファイルの使い方

### 1. 動作確認テスト（test-simple-verification.html）

このテストは、AutoAI拡張機能の各コンポーネントが正しく動作しているかを確認するためのシンプルなテストです。

#### 実行方法
1. Chrome拡張機能ページ（chrome://extensions/）でAutoAIが有効になっていることを確認
2. `test-simple-verification.html`をChromeで開く
3. 各セクションのボタンをクリックしてテストを実行

#### テスト項目
- **基本的な拡張機能の確認**: Chrome API、拡張機能の基本動作
- **モジュールとコンポーネント**: TestWindowManager、TestAutomationの読み込み
- **Content Script**: メッセージパッシング、AI サイトとの通信
- **ウィンドウ管理**: テストウィンドウの作成と配置
- **統合テスト準備**: 全コンポーネントの準備状態

### 2. メイン統合テスト（test-ai-simple-working-fixed.html）

3つのAI（ChatGPT、Claude、Gemini）を同時にテストする統合テストです。

#### 実行方法
1. `test-ai-simple-working-fixed.html`をChromeで開く
2. テストしたいAIにチェックを入れる
3. プロンプトを入力（デフォルト: "桃太郎を300文字で記載して"）
4. 「🚀 全AIテスト実行」ボタンをクリック

#### 動作フロー
1. 選択したAIのウィンドウが4分割で開く（左上・右上・左下）
2. 各AIにプロンプトが自動送信される
3. 回答が取得され、結果が表示される

### 3. トラブルシューティング

#### "Could not establish connection" エラー
- **原因**: Content Scriptがまだロードされていない
- **解決**: ページが完全に読み込まれるまで待つ

#### ウィンドウが開かない
- **原因**: ポップアップブロッカー
- **解決**: Chromeの設定でポップアップを許可

#### テストモジュールが見つからない
- **原因**: ファイルパスの問題
- **解決**: 拡張機能のルートディレクトリから実行

### 4. デバッグ方法

#### コンソールログの確認
1. F12キーで開発者ツールを開く
2. Consoleタブでログを確認
3. `[Debug]`で始まるメッセージを探す

#### Background Scriptのログ
1. chrome://extensions/ を開く
2. AutoAIの「Service Worker」をクリック
3. Consoleタブでログを確認

#### Content Scriptのログ
1. AIサイト（ChatGPT等）を開く
2. F12キーで開発者ツールを開く
3. Consoleタブでログを確認

### 5. テスト結果の見方

#### 成功パターン
```
✅ テスト成功！ 総実行時間: 5秒
📊 実行ステップ詳細:
  ✅ 1. 統合タスク実行（プロンプト送信→回答取得）: 5045ms
💬 回答結果: 300文字取得
📝 内容プレビュー: "昔々、ある村に..."
```

#### 失敗パターン
```
❌ テスト失敗: エラーメッセージ
📊 実行ステップ結果:
  ❌ 1. 統合タスク実行（プロンプト送信→回答取得）: 失敗 (10ms)
💥 失敗箇所: 統合タスク実行（プロンプト送信→回答取得） で問題が発生しました
```

### 6. 開発者向け情報

#### 新しいテストの追加方法
1. `tests/`ディレクトリに新しいHTMLファイルを作成
2. 必要なモジュールをインポート
3. テスト関数を実装
4. manifest.jsonの`web_accessible_resources`に追加

#### テストモジュールの構成
- `TestWindowManager`: ウィンドウ管理
- `TestAutomation`: 自動テスト実行
- `test-ai-simple-working-fixed.js`: メインテストロジック

#### メッセージフロー
```
テストページ → Background.js → Content Script → AI サイト
     ↑                                              ↓
     ←──────────── 結果 ←────────────────────────────┘
```