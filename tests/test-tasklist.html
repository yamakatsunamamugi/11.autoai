<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆãƒ†ã‚¹ãƒˆ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }

    .header h1 {
      font-size: 28px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .header .subtitle {
      opacity: 0.9;
      font-size: 14px;
    }

    .content {
      padding: 30px;
    }

    .input-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
    }

    .input-group {
      margin-bottom: 20px;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }

    .url-selector {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .url-input {
      flex: 1;
      padding: 10px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    .url-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .dropdown-button {
      padding: 10px 15px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }

    .dropdown-button:hover {
      background: #5a67d8;
    }

    .dropdown-menu {
      position: relative;
      display: none;
      background: white;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      margin-top: 5px;
      max-height: 200px;
      overflow-y: auto;
    }

    .dropdown-menu.show {
      display: block;
    }

    .dropdown-item {
      padding: 10px 15px;
      cursor: pointer;
      transition: background 0.2s;
      font-size: 14px;
    }

    .dropdown-item:hover {
      background: #f0f0f0;
    }

    .btn {
      padding: 12px 30px;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .status-message {
      padding: 15px;
      border-radius: 6px;
      margin-top: 20px;
      display: none;
    }

    .status-message.show {
      display: block;
    }

    .status-message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .status-message.loading {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    .task-list-container {
      margin-top: 30px;
      display: none;
    }

    .task-list-container.show {
      display: block;
    }

    .task-stats {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .stat-card {
      background: #f8f9fa;
      padding: 15px 20px;
      border-radius: 8px;
      flex: 1;
      min-width: 150px;
    }

    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #667eea;
    }

    .stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }

    .task-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .task-table th {
      background: #f8f9fa;
      padding: 12px;
      text-align: left;
      font-weight: 600;
      border-bottom: 2px solid #e0e0e0;
    }

    .task-table td {
      padding: 12px;
      border-bottom: 1px solid #e0e0e0;
    }

    .task-table tr:hover {
      background: #f8f9fa;
    }

    .ai-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }

    .ai-claude {
      background: #f0e6ff;
      color: #7c3aed;
    }

    .ai-gemini {
      background: #e6f7ff;
      color: #0891b2;
    }

    .ai-chatgpt {
      background: #f0fdf4;
      color: #16a34a;
    }

    .prompt-preview {
      max-width: 300px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: #555;
    }

    .model-badge {
      background: #fff3cd;
      color: #856404;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 11px;
      margin-left: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“‹ ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆãƒ†ã‚¹ãƒˆ</h1>
      <div class="subtitle">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«</div>
    </div>
    
    <div class="content">
      <!-- å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="input-section">
        <div class="input-group">
          <label for="spreadsheetUrl">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURL</label>
          <div class="url-selector">
            <input 
              type="url" 
              id="spreadsheetUrl" 
              class="url-input" 
              placeholder="https://docs.google.com/spreadsheets/d/..." 
              value="https://docs.google.com/spreadsheets/d/1C5aOSyyCBXf7HwF-BGGu-cz5jdRwNBaoW4G4ivIRrRg/edit?gid=1633283608#gid=1633283608"
            >
            <button class="dropdown-button" id="dropdownBtn">â–¼ ã‚µãƒ³ãƒ—ãƒ«</button>
          </div>
          <div class="dropdown-menu" id="dropdownMenu">
            <div class="dropdown-item" data-url="https://docs.google.com/spreadsheets/d/1C5aOSyyCBXf7HwF-BGGu-cz5jdRwNBaoW4G4ivIRrRg/edit?gid=1633283608#gid=1633283608">
              ãƒ†ã‚¹ãƒˆç”¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ1
            </div>
            <div class="dropdown-item" data-url="https://docs.google.com/spreadsheets/d/1C5aOSyyCBXf7HwF-BGGu-cz5jdRwNBaoW4G4ivIRrRg/edit">
              ãƒ†ã‚¹ãƒˆç”¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ2ï¼ˆgidãªã—ï¼‰
            </div>
          </div>
        </div>

        <button id="createTaskListBtn" class="btn btn-primary">
          ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆä½œæˆ
        </button>

        <div id="statusMessage" class="status-message"></div>
      </div>

      <!-- ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆè¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div id="taskListContainer" class="task-list-container">
        <h2 style="margin-bottom: 20px;">ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ</h2>
        
        <div class="task-stats">
          <div class="stat-card">
            <div class="stat-value" id="totalTasks">0</div>
            <div class="stat-label">ç·ã‚¿ã‚¹ã‚¯æ•°</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="executableTasks">0</div>
            <div class="stat-label">å®Ÿè¡Œå¯èƒ½</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="claudeTasks">0</div>
            <div class="stat-label">Claude</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="geminiTasks">0</div>
            <div class="stat-label">Gemini</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="chatgptTasks">0</div>
            <div class="stat-label">ChatGPT</div>
          </div>
        </div>

        <table class="task-table">
          <thead>
            <tr>
              <th>è¡Œ</th>
              <th>AI</th>
              <th>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆ—</th>
              <th>å›ç­”åˆ—</th>
              <th>ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</th>
              <th>ãƒ¢ãƒ‡ãƒ«/æ©Ÿèƒ½</th>
            </tr>
          </thead>
          <tbody id="taskTableBody">
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- ä¾å­˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
  <script src="../src/features/spreadsheet/config.js"></script>
  <script src="../src/features/spreadsheet/url-parser.js"></script>
  <script src="../src/services/auth-service.js"></script>
  <script src="../src/features/spreadsheet/sheets-client.js"></script>
  <script src="../src/services/spreadsheet-auto-setup.js"></script>
  
  <!-- ã‚¿ã‚¹ã‚¯ç”Ÿæˆé–¢é€£ -->
  <script type="module">
    import TaskGenerator from '../src/features/task/generator.js';
    
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
    let currentTaskList = null;
    
    // DOMè¦ç´ 
    const spreadsheetUrlInput = document.getElementById('spreadsheetUrl');
    const dropdownBtn = document.getElementById('dropdownBtn');
    const dropdownMenu = document.getElementById('dropdownMenu');
    const createTaskListBtn = document.getElementById('createTaskListBtn');
    const statusMessage = document.getElementById('statusMessage');
    const taskListContainer = document.getElementById('taskListContainer');
    
    // ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®åˆ¶å¾¡
    dropdownBtn.addEventListener('click', () => {
      dropdownMenu.classList.toggle('show');
    });
    
    // ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¯ãƒªãƒƒã‚¯
    document.querySelectorAll('.dropdown-item').forEach(item => {
      item.addEventListener('click', () => {
        spreadsheetUrlInput.value = item.dataset.url;
        dropdownMenu.classList.remove('show');
      });
    });
    
    // å¤–å´ã‚¯ãƒªãƒƒã‚¯ã§ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’é–‰ã˜ã‚‹
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.url-selector')) {
        dropdownMenu.classList.remove('show');
      }
    });
    
    // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    function showStatus(message, type = 'success') {
      statusMessage.textContent = message;
      statusMessage.className = `status-message show ${type}`;
      
      if (type !== 'loading') {
        setTimeout(() => {
          statusMessage.classList.remove('show');
        }, 5000);
      }
    }
    
    // ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆä½œæˆãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯
    createTaskListBtn.addEventListener('click', async () => {
      const url = spreadsheetUrlInput.value.trim();
      
      if (!url) {
        showStatus('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
        return;
      }
      
      // URLãƒ‘ãƒ¼ã‚¹
      const match = url.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);
      if (!match) {
        showStatus('æœ‰åŠ¹ãªã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURLã§ã¯ã‚ã‚Šã¾ã›ã‚“', 'error');
        return;
      }
      
      const spreadsheetId = match[1];
      const gidMatch = url.match(/[#&]gid=(\d+)/);
      const gid = gidMatch ? gidMatch[1] : null;
      
      createTaskListBtn.disabled = true;
      showStatus('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­...', 'loading');
      
      try {
        // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        console.log('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆèª­ã¿è¾¼ã¿é–‹å§‹:', spreadsheetId, gid);
        const spreadsheetData = await loadSpreadsheetData(spreadsheetId, gid);
        
        showStatus('ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆä¸­...', 'loading');
        
        // ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆ
        const taskGenerator = new TaskGenerator();
        currentTaskList = taskGenerator.generateTasks(spreadsheetData);
        
        console.log('ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ:', currentTaskList);
        
        // ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’è¡¨ç¤º
        displayTaskList(currentTaskList);
        
        showStatus(`ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼ˆ${currentTaskList.tasks.length}ä»¶ï¼‰`, 'success');
        
      } catch (error) {
        console.error('ã‚¨ãƒ©ãƒ¼:', error);
        showStatus(`ã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
      } finally {
        createTaskListBtn.disabled = false;
      }
    });
    
    // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ï¼ˆæœ¬ç•ªã¨å®Œå…¨ã«åŒã˜å‡¦ç†ï¼‰
    async function loadSpreadsheetData(spreadsheetId, gid) {
      // 1. æœ¬ç•ªã¨åŒã˜sheetsClient.loadAutoAIDataã‚’ä½¿ç”¨
      const sheetsClient = new SheetsClient();
      const updatedSpreadsheetData = await sheetsClient.loadAutoAIData(spreadsheetId, gid);
      
      // 2. è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæœ¬ç•ªã¨åŒã˜ï¼‰
      const autoSetup = new SpreadsheetAutoSetup();
      const token = await globalThis.authService.getAuthToken();
      await autoSetup.executeAutoSetup(spreadsheetId, token, gid);
      
      // 3. ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢ï¼ˆæœ¬ç•ªã¨åŒã˜processSpreadsheetDataé–¢æ•°ï¼‰
      const processedData = processSpreadsheetData(updatedSpreadsheetData);
      
      console.log('[Test] æœ¬ç•ªã¨åŒã˜å‡¦ç†ã§èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿:', {
        aiColumns: processedData.aiColumns,
        columnCount: Object.keys(processedData.columnMapping || {}).length,
        valueRows: updatedSpreadsheetData.values?.length || 0,
      });
      
      return processedData;
    }
    
    // æœ¬ç•ªã®processSpreadsheetDataé–¢æ•°ã¨åŒã˜
    function processSpreadsheetData(spreadsheetData) {
      const result = {
        ...spreadsheetData,
        aiColumns: [],
        columnMapping: {},
      };
      
      if (!spreadsheetData.values || spreadsheetData.values.length === 0) {
        return result;
      }
      
      const headerRow = spreadsheetData.values[0];
      headerRow.forEach((header, index) => {
        const columnLetter = String.fromCharCode(65 + index);
        const trimmedHeader = header.trim();
        
        if (
          trimmedHeader.startsWith("ChatGPT ") ||
          trimmedHeader.startsWith("Claude ") ||
          trimmedHeader.startsWith("Gemini ")
        ) {
          const [ai, ...rest] = trimmedHeader.split(" ");
          const promptDescription = rest.join(" ");
          result.aiColumns.push({
            index,
            letter: columnLetter,
            header: trimmedHeader,
            ai,
            promptDescription,
          });
        }
        
        result.columnMapping[columnLetter] = {
          index,
          header: trimmedHeader,
        };
      });
      
      return result;
    }
    
    // ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºï¼ˆæœ¬ç•ªã®ã‚¿ã‚¹ã‚¯æ§‹é€ ã«åˆã‚ã›ã¦è¡¨ç¤ºï¼‰
    function displayTaskList(taskList) {
      if (!taskList || !taskList.tasks) {
        return;
      }
      
      // çµ±è¨ˆæƒ…å ±ã‚’è¡¨ç¤º
      const stats = taskList.getStatistics();
      document.getElementById('totalTasks').textContent = stats.total;
      document.getElementById('executableTasks').textContent = stats.executable;
      document.getElementById('claudeTasks').textContent = stats.byAI.claude || 0;
      document.getElementById('geminiTasks').textContent = stats.byAI.gemini || 0;
      document.getElementById('chatgptTasks').textContent = stats.byAI.chatgpt || 0;
      
      // ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ãƒªã‚¢
      const tbody = document.getElementById('taskTableBody');
      tbody.innerHTML = '';
      
      // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆ—ã”ã¨ã«ã‚¿ã‚¹ã‚¯ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼ˆæœ¬ç•ªã¨åŒã˜è¡¨ç¤ºå½¢å¼ï¼‰
      const tasksByPromptColumn = {};
      taskList.tasks.forEach(task => {
        const key = task.promptColumn;
        if (!tasksByPromptColumn[key]) {
          tasksByPromptColumn[key] = [];
        }
        tasksByPromptColumn[key].push(task);
      });
      
      // ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤ºï¼ˆå®Ÿè¡Œå¯èƒ½ãªã‚‚ã®ã®ã¿ã€ã¾ãŸã¯ã™ã¹ã¦ï¼‰
      taskList.tasks.forEach(task => {
        // ã‚¹ã‚­ãƒƒãƒ—ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã¯è–„ãè¡¨ç¤º
        const isSkipped = !task.isExecutable();
        const row = document.createElement('tr');
        if (isSkipped) {
          row.style.opacity = '0.5';
        }
        
        // AIã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸãƒãƒƒã‚¸ã‚¯ãƒ©ã‚¹
        const aiBadgeClass = `ai-${task.aiType}`;
        
        // ã‚¿ã‚¹ã‚¯ã‚¿ã‚¤ãƒ—ã®è¡¨ç¤ºï¼ˆAIã‚¿ã‚¹ã‚¯ã‹ãƒ¬ãƒãƒ¼ãƒˆã‚¿ã‚¹ã‚¯ã‹ï¼‰
        const taskTypeLabel = task.taskType === 'report' ? '[ãƒ¬ãƒãƒ¼ãƒˆ]' : '';
        
        // ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆæœ€åˆã®100æ–‡å­—ã€æ”¹è¡Œã¯ç©ºç™½ã«ç½®æ›ï¼‰
        let promptPreview = '';
        if (task.taskType === 'report') {
          promptPreview = `ãƒ¬ãƒãƒ¼ãƒˆåŒ–: ${task.sourceColumn}åˆ— â†’ ${task.reportColumn}åˆ—`;
        } else if (task.prompt) {
          const cleanPrompt = task.prompt.replace(/\n/g, ' ');
          promptPreview = cleanPrompt.length > 100 ? 
            cleanPrompt.substring(0, 100) + '...' : cleanPrompt;
        } else {
          promptPreview = '(ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãªã—)';
        }
        
        // ãƒ¢ãƒ‡ãƒ«/æ©Ÿèƒ½ã®è¡¨ç¤º
        const extras = [];
        if (task.model) extras.push(`<span class="model-badge">ãƒ¢ãƒ‡ãƒ«: ${task.model}</span>`);
        if (task.specialOperation) extras.push(`<span class="model-badge">æ©Ÿèƒ½: ${task.specialOperation}</span>`);
        if (task.skipReason) extras.push(`<span class="model-badge" style="background: #ffcccc;">ã‚¹ã‚­ãƒƒãƒ—: ${task.skipReason}</span>`);
        
        // ã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±
        let groupInfo = '';
        if (task.groupInfo) {
          if (task.groupInfo.type === '3type') {
            groupInfo = ' [3ç¨®é¡AI]';
          } else if (task.groupInfo.type === 'single') {
            groupInfo = ' [å˜ç‹¬AI]';
          } else if (task.groupInfo.type === 'report') {
            groupInfo = ' [ãƒ¬ãƒãƒ¼ãƒˆ]';
          }
        }
        
        row.innerHTML = `
          <td>${task.row}</td>
          <td><span class="ai-badge ${aiBadgeClass}">${task.aiType.toUpperCase()}</span>${taskTypeLabel}</td>
          <td>${task.promptColumn || '-'}</td>
          <td>${task.column}${groupInfo}</td>
          <td class="prompt-preview" title="${task.prompt ? task.prompt.replace(/"/g, '&quot;') : ''}">${promptPreview}</td>
          <td>${extras.join(' ')}</td>
        `;
        
        tbody.appendChild(row);
      });
      
      // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ï¼ˆæœ¬ç•ªã¨åŒã˜ï¼‰
      console.groupCollapsed('[Test] ç”Ÿæˆã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆè©³ç´°');
      Object.keys(tasksByPromptColumn).sort().forEach(promptColumn => {
        const columnTasks = tasksByPromptColumn[promptColumn];
        console.log(`\nã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆ— ${promptColumn}ã€‘ã‚¿ã‚¹ã‚¯æ•°: ${columnTasks.length}`);
        
        columnTasks.forEach((task, index) => {
          console.log(`  ${index + 1}. ${task.column}${task.row} (${task.aiType})`);
          if (task.model) console.log(`     ãƒ¢ãƒ‡ãƒ«: ${task.model}`);
          if (task.specialOperation) console.log(`     æ©Ÿèƒ½: ${task.specialOperation}`);
          if (task.skipReason) console.log(`     ã‚¹ã‚­ãƒƒãƒ—: ${task.skipReason}`);
        });
      });
      console.groupEnd();
      
      // ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒŠã‚’è¡¨ç¤º
      taskListContainer.classList.add('show');
    }
  </script>
</body>
</html>