<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ‹¡å¼µæ©Ÿèƒ½ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚«ãƒ¼</title>
  <style>
    body {
      font-family: 'Hiragino Sans', Meiryo, sans-serif;
      max-width: 900px;
      margin: 20px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #e53e3e;
      border-bottom: 3px solid #e53e3e;
      padding-bottom: 10px;
    }
    .error-box {
      background: #fff5f5;
      border: 2px solid #fc8181;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
    }
    .step {
      background: #f7fafc;
      border-left: 4px solid #4299e1;
      padding: 15px;
      margin: 15px 0;
    }
    code {
      background: #2d3748;
      color: #48bb78;
      padding: 2px 8px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
    }
    .important {
      background: #fef5e7;
      border: 2px solid #f39c12;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
    }
    pre {
      background: #1a202c;
      color: #68d391;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
    }
    .button {
      background: #4299e1;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 5px;
    }
    .button:hover {
      background: #3182ce;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” Service Worker ã‚¨ãƒ©ãƒ¼ã®ç¢ºèªæ–¹æ³•</h1>
    
    <div class="error-box">
      <h2>Status Code: 3 ãŒå‡ºç¶šã‘ã‚‹å ´åˆ</h2>
      <p>ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ä»¥ä¸‹ã®2ã¤ã®åŸå› ã®ã©ã¡ã‚‰ã‹ã§ã™ï¼š</p>
      <ol>
        <li><strong>ã¾ã file://ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹</strong></li>
        <li><strong>background.jsã¾ãŸã¯ãã®ä¾å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹</strong></li>
      </ol>
    </div>

    <div class="important">
      <h2>ğŸ“‹ ä»Šã™ãç¢ºèªã—ã¦ãã ã•ã„</h2>
      <p><strong>è³ªå•1:</strong> ä»Šã€ã©ã®URLã§ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ</p>
      <ul>
        <li>âŒ <code>file:///Users/...</code> ã§å§‹ã¾ã‚‹ â†’ ã¾ã ç›´æ¥é–‹ã„ã¦ã„ã¾ã™</li>
        <li>âœ… <code>chrome-extension://...</code> ã§å§‹ã¾ã‚‹ â†’ æ­£ã—ãé–‹ã„ã¦ã„ã¾ã™</li>
      </ul>
    </div>

    <div class="step">
      <h3>ã‚‚ã— chrome-extension:// ã§é–‹ã„ã¦ã„ã‚‹ã®ã«ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆï¼š</h3>
      <p><strong>å®Ÿéš›ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š</strong></p>
    </div>

    <h2>ğŸ› ï¸ Service Worker ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹æ‰‹é †</h2>
    
    <div class="step">
      <h3>æ–¹æ³•1: æ‹¡å¼µæ©Ÿèƒ½ãƒšãƒ¼ã‚¸ã‹ã‚‰ç¢ºèª</h3>
      <ol>
        <li><code>chrome://extensions/</code> ã‚’é–‹ã</li>
        <li>ã€ŒAutoAI Minimalã€ã‚’è¦‹ã¤ã‘ã‚‹</li>
        <li>ä»¥ä¸‹ã®ã©ã‚Œã‹ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼š
          <ul>
            <li><strong style="color: red;">ã€Œã‚¨ãƒ©ãƒ¼ã€</strong>ãƒœã‚¿ãƒ³ï¼ˆèµ¤ã„æ–‡å­—ã§è¡¨ç¤ºã•ã‚Œã‚‹ï¼‰</li>
            <li><strong>ã€Œãƒ“ãƒ¥ãƒ¼ã‚’æ¤œè¨¼: Service Workerã€</strong>ãƒªãƒ³ã‚¯</li>
          </ul>
        </li>
        <li>é–‹ã„ãŸã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
      </ol>
    </div>

    <div class="step">
      <h3>æ–¹æ³•2: ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«ã‹ã‚‰ç¢ºèª</h3>
      <ol>
        <li>chrome-extension://[ID]/tests/test-tasklist.html ã‚’é–‹ã</li>
        <li>F12ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ„ãƒ¼ãƒ«ã‚’é–‹ã</li>
        <li>Consoleã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
        <li>èµ¤ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª</li>
      </ol>
    </div>

    <h2>ğŸ”´ ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ–¹æ³•</h2>
    
    <div class="error-box">
      <h3>ã‚¨ãƒ©ãƒ¼ä¾‹1: Uncaught SyntaxError: Cannot use import statement outside a module</h3>
      <p>â†’ manifest.jsonã® "type": "module" è¨­å®šã®å•é¡Œ</p>
    </div>

    <div class="error-box">
      <h3>ã‚¨ãƒ©ãƒ¼ä¾‹2: Failed to load module script</h3>
      <p>â†’ ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã€ã¾ãŸã¯ãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹</p>
    </div>

    <div class="error-box">
      <h3>ã‚¨ãƒ©ãƒ¼ä¾‹3: Uncaught ReferenceError: [å¤‰æ•°å] is not defined</h3>
      <p>â†’ ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã®å‚ç…§ã‚¨ãƒ©ãƒ¼</p>
    </div>

    <div class="important">
      <h2>âš ï¸ é‡è¦ãªç¢ºèªäº‹é …</h2>
      <p><strong>ä»¥ä¸‹ã®æƒ…å ±ã‚’æ•™ãˆã¦ãã ã•ã„ï¼š</strong></p>
      <ol>
        <li>ç¾åœ¨ã®URLï¼ˆã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ï¼‰</li>
        <li>chrome://extensions/ ã®ã€ŒAutoAI Minimalã€ã«<span style="color:red;">èµ¤ã„ã‚¨ãƒ©ãƒ¼è¡¨ç¤º</span>ãŒã‚ã‚‹ã‹</li>
        <li>ã€Œãƒ“ãƒ¥ãƒ¼ã‚’æ¤œè¨¼: Service Workerã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼</li>
      </ol>
    </div>

    <button class="button" onclick="checkCurrentContext()">ç¾åœ¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç¢ºèª</button>
    <div id="contextInfo" style="margin-top: 20px;"></div>
  </div>

  <script>
    function checkCurrentContext() {
      const info = document.getElementById('contextInfo');
      const url = window.location.href;
      const protocol = window.location.protocol;
      
      let html = '<div style="padding: 15px; border-radius: 8px; ';
      
      if (protocol === 'file:') {
        html += 'background: #fee; border: 2px solid #f00;">';
        html += '<h3>âŒ å•é¡Œ: file:// ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™</h3>';
        html += '<p>ç¾åœ¨ã®URL: ' + url + '</p>';
        html += '<p><strong>ã“ã‚ŒãŒåŸå› ã§Service Workerã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚</strong></p>';
        html += '<p>è§£æ±ºæ–¹æ³•: Chromeæ‹¡å¼µæ©Ÿèƒ½ã¨ã—ã¦èª­ã¿è¾¼ã‚“ã§ã€chrome-extension:// ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãã ã•ã„ã€‚</p>';
      } else if (protocol === 'chrome-extension:') {
        html += 'background: #efe; border: 2px solid #0a0;">';
        html += '<h3>âœ… æ­£ã—ãchrome-extension://ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™</h3>';
        html += '<p>æ‹¡å¼µæ©Ÿèƒ½ID: ' + (chrome.runtime ? chrome.runtime.id : 'ä¸æ˜') + '</p>';
        html += '<p>ãã‚Œã§ã‚‚ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆã¯ã€background.jsã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚</p>';
        html += '<p><strong>chrome://extensions/ ã§ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</strong></p>';
      } else {
        html += 'background: #ffe; border: 2px solid #fa0;">';
        html += '<h3>âš ï¸ ä¸æ˜ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«: ' + protocol + '</h3>';
      }
      
      html += '</div>';
      info.innerHTML = html;
    }
  </script>
</body>
</html>