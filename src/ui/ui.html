<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="ui.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>AutoAI Control Panel</h1>
    </header>
    
    <main>
      <!-- ステップ1: スプレッドシートURL入力セクション -->
      <section class="step-section">
        <div class="step-header">
          <span class="step-number">1</span>
          <h2>スプレッドシートを設定</h2>
        </div>
        <div class="step-content">
          <div id="urlInputs">
            <div class="url-input-group">
              <input type="url" class="url-input" placeholder="https://docs.google.com/spreadsheets/d/...">
              <button class="btn-remove" style="display:none">×</button>
            </div>
          </div>
          <button id="addUrlBtn" class="btn btn-add">+ URL入力欄を追加</button>
          <button id="loadSheetsBtn" class="btn btn-primary btn-large">
            <span class="btn-icon">📊</span>
            スプレッドシートを読み込む
          </button>
          <div id="loadFeedback" class="feedback-message"></div>
          
          <!-- 列状況カード -->
          <div id="columnStatusCard" class="column-status-card" style="display:none">
            <div class="card-header">
              <span class="card-icon">📋</span>
              <span class="card-title">列の状況</span>
            </div>
            <div class="card-content">
              <p id="columnStatusMessage" class="status-message"></p>
              <div id="columnStatusActions" class="card-actions" style="display:none">
                <button id="undoColumnsBtn" class="btn btn-secondary btn-small">
                  <span class="btn-icon">↶</span>
                  元に戻す
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <!-- ステップ2: 処理実行セクション -->
      <section class="step-section">
        <div class="step-header">
          <span class="step-number">2</span>
          <h2>処理を実行</h2>
        </div>
        <div class="step-content">
          <button id="startBtn" class="btn btn-primary btn-large">
            <span class="btn-icon">▶</span>
            処理を開始
          </button>
          <div class="control-buttons">
            <button id="stopBtn" class="btn btn-danger" disabled>
              <span class="btn-icon">■</span>
              処理停止
            </button>
            <button id="clearLogBtn" class="btn btn-secondary">
              <span class="btn-icon">🗑</span>
              ログクリア
            </button>
            <button id="deleteAnswersBtn" class="btn btn-secondary">
              <span class="btn-icon">✕</span>
              回答削除
            </button>
          </div>
        </div>
      </section>
      
      <!-- ステータス表示 -->
      <section class="status-section">
        <div id="status" class="status">
          <span class="status-icon">⏸</span>
          <span class="status-text">待機中</span>
        </div>
      </section>

      <!-- テストセクション -->
      <section class="step-section">
        <div class="step-header">
          <span class="step-number">🧪</span>
          <h2>AIテスト機能</h2>
        </div>
        <div class="step-content">
          <p class="test-description">AIの動作確認とパフォーマンステストを実行できます</p>
          <div class="control-buttons">
            <button id="startIntegratedTestBtn" class="btn btn-primary btn-large">
              <span class="btn-icon">🎯</span>
              統合AIテスト開始
            </button>
            <button id="openTestModalBtn" class="btn btn-info btn-large">
              <span class="btn-icon">🧪</span>
              テストセンターを開く
            </button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- テストモーダル -->
  <div id="testModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>🧪 AIテストセンター</h2>
        <span class="modal-close" id="closeTestModal">&times;</span>
      </div>
      <div class="modal-body">
        <div class="test-grid">
          <!-- 統合AIテスト（最新） -->
          <div class="test-card featured">
            <div class="test-card-header">
              <span class="test-icon">🎯</span>
              <h3>統合AIテスト（最新）</h3>
            </div>
            <div class="test-card-body">
              <p>全AI機能を1つのテストで包括的に実行します</p>
              <ul class="test-features">
                <li>✓ 標準AI処理（ChatGPT・Claude・Gemini）</li>
                <li><label><input type="checkbox" id="enableSpecialModels"> 特殊モデル（o3・Computer Use・思考モード）</label></li>
                <li><label><input type="checkbox" id="enableDeepResearch"> DeepResearch（最大15分の深層調査）</label></li>
                <li>
                  <label for="chatgptToolMode">ChatGPTツール: 
                    <select id="chatgptToolMode" style="margin-left: 10px; padding: 4px 8px; border-radius: 4px; border: 1px solid #ccc;">
                      <option value="default">標準</option>
                      <option value="ChatGPTAgent">エージェントモード</option>
                      <option value="ChatGPTCanvas">Canvas</option>
                      <option value="ChatGPTWebSearch">ウェブ検索</option>
                      <option value="ChatGPTImage">画像生成</option>
                      <option value="DeepResearch">DeepResearch</option>
                    </select>
                  </label>
                </li>
              </ul>
              <div style="margin-top: 15px; padding: 10px; background: #e7f3ff; border-radius: 6px; font-size: 13px;">
                <strong>📋 実行手順：</strong><br>
                1. 各AIサイトのウィンドウを自動で開きます<br>
                2. テストプロンプトを入力欄に自動入力します<br>
                3. 送信ボタン（➤）を自動でクリックします<br>
                4. AI応答を待機し、結果を取得します<br>
                5. 全AIの応答を比較・分析します
              </div>
              <button class="btn btn-primary test-btn" data-test="comprehensive">
                <span class="btn-icon">🎯</span>
                統合AIテスト開始
              </button>
            </div>
          </div>

          <!-- 応答比較テスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">📊</span>
              <h3>応答比較テスト</h3>
            </div>
            <div class="test-card-body">
              <p>ChatGPT、Claude、Geminiの応答を比較します</p>
              <ul class="test-features">
                <li>✓ AI別応答測定</li>
                <li>✓ 速度比較</li>
                <li>✓ 品質評価</li>
              </ul>
              <div style="margin-top: 15px; padding: 10px; background: #f0fff4; border-radius: 6px; font-size: 13px;">
                <strong>📋 実行手順：</strong><br>
                1. 同じ質問を3つのAIに送信<br>
                2. 各AIの応答時間を測定<br>
                3. 応答の文字数と品質を比較<br>
                4. 結果を表形式で表示
              </div>
              <button class="btn btn-success test-btn" data-test="responses">
                <span class="btn-icon">📈</span>
                応答比較開始
              </button>
            </div>
          </div>

          <!-- 基本テスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">⚡</span>
              <h3>基本テスト</h3>
            </div>
            <div class="test-card-body">
              <p>AIの基本的な応答テストを実行します</p>
              <ul class="test-features">
                <li>✓ ステップ別実行</li>
                <li>✓ 初心者向け</li>
                <li>✓ ガイド付き</li>
              </ul>
              <div style="margin-top: 15px; padding: 10px; background: #fffbf0; border-radius: 6px; font-size: 13px;">
                <strong>📋 実行手順：</strong><br>
                1. AIウィンドウの開放確認<br>
                2. 「こんにちは」を入力<br>
                3. 送信して応答確認<br>
                4. 基本動作の成功を確認
              </div>
              <button class="btn btn-success test-btn" data-test="simple">
                <span class="btn-icon">🚀</span>
                基本テスト開始
              </button>
            </div>
          </div>


          <!-- コンテンツスクリプトテスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">🔧</span>
              <h3>コンテンツスクリプトテスト</h3>
            </div>
            <div class="test-card-body">
              <p>コンテンツスクリプトの動作を詳細にテストします</p>
              <ul class="test-features">
                <li>✓ セレクタ検証</li>
                <li>✓ 通信テスト</li>
                <li>✓ エラー検出</li>
              </ul>
              <button class="btn btn-info test-btn" data-test="content">
                <span class="btn-icon">🔍</span>
                詳細テスト開始
              </button>
            </div>
          </div>

          <!-- スプレッドシートテスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">📋</span>
              <h3>スプレッドシートテスト</h3>
            </div>
            <div class="test-card-body">
              <p>スプレッドシートの読み込みと処理をテストします</p>
              <ul class="test-features">
                <li>✓ 読み込みテスト</li>
                <li>✓ データ解析</li>
                <li>✓ エラーハンドリング</li>
              </ul>
              <button class="btn btn-secondary test-btn" data-test="spreadsheet">
                <span class="btn-icon">📊</span>
                スプレッドシートテスト
              </button>
            </div>
          </div>

          <!-- タスク生成テスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">⚙️</span>
              <h3>タスク生成テスト</h3>
            </div>
            <div class="test-card-body">
              <p>AIタスクの生成機能をテストします</p>
              <ul class="test-features">
                <li>✓ タスク作成</li>
                <li>✓ 列制御</li>
                <li>✓ 生成ロジック</li>
              </ul>
              <button class="btn btn-secondary test-btn" data-test="task-generation">
                <span class="btn-icon">🔧</span>
                タスク生成テスト
              </button>
            </div>
          </div>

          <!-- ストリーミングテスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">🌊</span>
              <h3>ストリーミングテスト</h3>
            </div>
            <div class="test-card-body">
              <p>リアルタイムストリーミング処理をテストします</p>
              <ul class="test-features">
                <li>✓ リアルタイム処理</li>
                <li>✓ 並列ストリーミング</li>
                <li>✓ パフォーマンス測定</li>
              </ul>
              <button class="btn btn-primary test-btn" data-test="streaming">
                <span class="btn-icon">🌊</span>
                ストリーミングテスト
              </button>
            </div>
          </div>


          <!-- ログ・削除テスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">🗑️</span>
              <h3>ログ・削除テスト</h3>
            </div>
            <div class="test-card-body">
              <p>ログクリアと回答削除機能をテストします</p>
              <ul class="test-features">
                <li>✓ ログクリア</li>
                <li>✓ 回答削除</li>
                <li>✓ データ管理</li>
              </ul>
              <button class="btn btn-secondary test-btn" data-test="log-delete">
                <span class="btn-icon">🧹</span>
                ログ・削除テスト
              </button>
            </div>
          </div>

          <!-- 拡張機能テスト -->
          <div class="test-card">
            <div class="test-card-header">
              <span class="test-icon">🔌</span>
              <h3>拡張機能テスト</h3>
            </div>
            <div class="test-card-body">
              <p>Chrome拡張機能の基本動作をテストします</p>
              <ul class="test-features">
                <li>✓ 拡張機能API</li>
                <li>✓ 権限確認</li>
                <li>✓ 基本機能</li>
              </ul>
              <button class="btn btn-secondary test-btn" data-test="extension">
                <span class="btn-icon">🔌</span>
                拡張機能テスト
              </button>
            </div>
          </div>





          <!-- AI操作ガイド -->
          <div class="test-card featured">
            <div class="test-card-header">
              <span class="test-icon">📖</span>
              <h3>AI操作ガイド</h3>
            </div>
            <div class="test-card-body">
              <p>初心者でもわかりやすいAI操作の説明書です</p>
              <ul class="test-features">
                <li>✓ 図解付き操作手順</li>
                <li>✓ 初心者向け説明</li>
                <li>✓ ステップバイステップガイド</li>
              </ul>
              <button class="btn btn-info guide-btn" data-guide="ai-operations">
                <span class="btn-icon">📖</span>
                AI操作ガイドを見る
              </button>
            </div>
          </div>
        </div>
        
        <div class="test-info">
          <h4>📋 テスト実行前の確認事項</h4>
          <ul class="test-checklist">
            <li>✓ Chrome拡張機能が正常に読み込まれている</li>
            <li>✓ インターネット接続が安定している</li>
            <li>✓ ポップアップブロッカーが無効になっている</li>
            <li>✓ 必要に応じてAIサイトにログイン済み</li>
          </ul>
        </div>
        
        <!-- テスト実行エリア -->
        <div id="testExecutionArea" class="test-execution-area" style="display:none">
          <div class="test-execution-header">
            <h4>🧪 テスト実行中</h4>
            <button id="closeTestExecution" class="btn btn-secondary btn-small">
              <span class="btn-icon">✕</span>
              閉じる
            </button>
          </div>
          <div class="test-execution-content">
            <iframe id="testFrame" class="test-iframe" src=""></iframe>
          </div>
        </div>
        
        <!-- AI操作ガイドエリア -->
        <div id="guideArea" class="guide-area" style="display:none">
          <div class="guide-header">
            <h4>📖 AI操作ガイド</h4>
            <button id="closeGuide" class="btn btn-secondary btn-small">
              <span class="btn-icon">✕</span>
              閉じる
            </button>
          </div>
          <div class="guide-content">
            <div id="guideContent" class="guide-text"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- 依存スクリプトを読み込み -->
  <script src="../features/spreadsheet/config.js"></script>
  <script src="../features/spreadsheet/url-parser.js"></script>
  <script src="../services/auth-service.js"></script>
  <script src="../features/spreadsheet/reader.js"></script>
  <!-- UIコントローラー -->
  <script src="ui-controller.js"></script>
</body>
</html>