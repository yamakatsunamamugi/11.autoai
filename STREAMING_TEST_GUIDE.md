# 🌊 ストリーミング処理 実動作テストガイド

## 📋 テスト概要

このガイドでは、実装した並列ストリーミング処理機能をChrome拡張機能として実際にテストする方法を説明します。

## 🚀 テスト手順

### 1. Chrome拡張機能の読み込み

1. **Chromeを開き、拡張機能管理画面へ**
   ```
   chrome://extensions/
   ```

2. **デベロッパーモードを有効化**
   - 右上の「デベロッパーモード」をONにする

3. **拡張機能を読み込み**
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - `/Users/roudousha/Dropbox/3.auto-ai/11.autoai/` フォルダを選択

### 2. テスト方法

#### 方法A: メインUIでテスト（推奨）

1. **拡張機能のアイコンをクリック**
   - AutoAI Minimalのアイコンが表示される
   - クリックするとメインUIウィンドウが開く

2. **ストリーミング処理テスト**
   - スプレッドシートURLを入力（任意のURL、実際に読み込まなくてもテスト可能）
   - 「🌊 ストリーミング処理開始」ボタンをクリック
   - **4つのAIウィンドウが段階的に開かれることを確認**

#### 方法B: 専用テストページでテスト

1. **テストページを開く**
   ```
   file:///Users/roudousha/Dropbox/3.auto-ai/11.autoai/tests/test-real-streaming.html
   ```

2. **テスト実行**
   - 「📊 モックデータでストリーミングテスト」ボタンをクリック
   - ログでストリーミング処理の進行を確認

3. **ウィンドウ位置テスト**
   - 「🪟 ウィンドウ位置テスト」ボタンをクリック
   - 4分割レイアウトでウィンドウが開かれることを確認

## 📊 確認ポイント

### ✅ ウィンドウの開閉動作

1. **順次開閉**: 4つのウィンドウがいきなり全て開くのではなく、段階的に開く
2. **配置**: 左上→右上→左下→右下の順で4分割配置される
3. **URL**: 各AIサービスの正しいURLが開かれる
   - Claude: `https://claude.ai/new`
   - ChatGPT: `https://chatgpt.com/?model=gpt-4o`
   - Gemini: `https://gemini.google.com/app`
   - ChatGPT o3: `https://chatgpt.com/?model=o3`

### ✅ 波のような処理パターン

1. **最初の列から開始**: C列（Claude）が最初に開始
2. **完了で次を開始**: C列のタスクが完了したらF列（ChatGPT）を開始
3. **並列進行**: 複数の列が同時に作業（ただし開始は段階的）

### ✅ ログ出力

デベロッパーツール（F12）のコンソールで以下のログを確認：

```
[StreamProcessor] ストリーミング処理開始
[StreamProcessor] C列用のウィンドウを開く
[StreamProcessor] ウィンドウ作成: C列 (claude) - 位置: 左上
[StreamProcessor] F列用のウィンドウを開く
[StreamProcessor] ウィンドウ作成: F列 (chatgpt) - 位置: 右上
```

## 🛠️ トラブルシューティング

### 問題: ウィンドウが開かない

**原因**: 権限不足
**解決策**: 
1. `manifest.json`で`system.display`権限が追加されているか確認
2. 拡張機能を再読み込み

### 問題: エラーが発生する

**原因**: モジュール読み込みエラー
**解決策**:
1. デベロッパーツールでエラー内容を確認
2. `background.js`でインポートが正しく設定されているか確認
3. ファイルパスに間違いがないか確認

### 問題: ストリーミング処理が動作しない

**原因**: メッセージハンドラーの設定不備
**解決策**:
1. `src/core/message-handler.js`で`startStreaming`アクションが定義されているか確認
2. StreamingServiceManagerが正しく初期化されているか確認

## 📈 期待される動作

### 正常な動作シーケンス

1. **開始**: 「ストリーミング処理開始」ボタンクリック
2. **初期化**: StreamingServiceManagerが初期化
3. **第1段階**: C列用のClaudeウィンドウが左上に開く
4. **第2段階**: C列処理完了後、F列用のChatGPTウィンドウが右上に開く
5. **第3段階**: F列処理完了後、I列用のGeminiウィンドウが左下に開く
6. **第4段階**: I列処理完了後、L列用のChatGPT o3ウィンドウが右下に開く
7. **完了**: 全ての処理が完了し、ウィンドウが適切に管理される

### UI表示

- **ステータス**: 「🌊 並列ストリーミング処理実行中」と表示
- **フィードバック**: 「ストリーミング処理開始: 4個のウィンドウで並列処理中」と表示
- **ボタン状態**: ストリーミング開始ボタンが無効化、停止ボタンが有効化

## 🎯 テスト成功の判定基準

✅ **全て満たされればテスト成功**

1. Chrome拡張機能として正常に読み込まれる
2. ストリーミング処理ボタンが機能する
3. 4つのAIウィンドウが段階的に開かれる
4. ウィンドウが4分割レイアウトで配置される
5. エラーが発生しない
6. 停止機能が正常に動作する

このテストが成功すれば、並列ストリーミング処理の実装が完了し、実際の業務で使用可能な状態となります。